<!DOCTYPE html>
<head>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.27.0/moment.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
  <script type="text/javascript" src="tokenlib.js"></script>
  <script>
    window.addEventListener("load", function(){
      function sendData(accesskey,secretkey){
        const XHR = new XMLHttpRequest();
        XHR.addEventListener( "load", function(event) {
          alert( event.target.responseText );
        } );
        XHR.addEventListener( "error", function( event ) {
          alert( 'Oops! Something went wrong.' );
        } );
        XHR.open( "POST", "http://localhost:8000/login" );
        XHR.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        const token = get_bearer_token(accesskey,secretkey);
        console.log(token)
        XHR.send(JSON.stringify({"token": token}));
      }
      const button = document.getElementById( "button" );
      button.addEventListener( "click", function ( event ) {
        sendData(document.getElementById('accesskey').value,document.getElementById('secretkey').value);
      } );
    });
  </script>
</head>
<body>
  <section class="loginform cf">
    <form name="login" id="login" action="/login" method="post" accept-charset="utf-8">
      <ul>
        <li>
          <label for="accesskey">aws_access_key_id</label>
          <input name="accesskey" id="accesskey" required>
        </li>
        <li>
          <label for="secretkey">aws_secret_access_key</label>
          <input type="password" name="secretkey" id="secretkey" required>
        </li>
        <li>
          <input type="submit" value="Login">
        </li>
      </ul>
    </form>
    <button id="button">get token</button>
  </section>
</body>
</html>
